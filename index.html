        <!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Party Guessing Game — Single File</title>
  <style>
    :root{
      --primary:#c8102e; /* consistent color */
      --bg:#0f172a;
      --card-bg: #0b1220;
      --muted: #94a3b8;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:linear-gradient(180deg,#071029, #07182b);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .app{width:100%;max-width:900px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.7)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    header h1{font-size:1.2rem;margin:0}
    .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    select,input[type=number]{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:8px 10px;border-radius:8px;color:inherit}
    button{background:var(--primary);border:none;color:white;padding:9px 12px;border-radius:8px;font-weight:600;cursor:pointer}
    .flex-row{display:flex;gap:12px;align-items:center}.game-area{display:grid;grid-template-columns:1fr 280px;gap:16px}

/* Card area */
.card-stage{background:var(--card-bg);border-radius:10px;padding:14px;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:420px}
.timer{font-weight:700;font-size:1.05rem;color:var(--primary)}
.card{position:relative;width:100%;max-width:560px;height:320px;border-radius:10px;overflow:hidden;background:linear-gradient(180deg,#081226, #071a2a);display:flex;align-items:center;justify-content:center}
.card img{width:100%;height:100%;object-fit:cover;display:block}
.caption{position:absolute;left:12px;bottom:10px;background:rgba(0,0,0,0.45);backdrop-filter:blur(4px);padding:6px 10px;border-radius:999px;font-weight:600}
.overlay{position:absolute;inset:0;display:flex}
.overlay > div{flex:1}
.overlay > div:hover{cursor:pointer;background:linear-gradient(90deg, rgba(255,255,255,0.03), transparent)}
.overlay .left{display:flex;align-items:center;justify-content:flex-start;padding-left:10px}
.overlay .right{display:flex;align-items:center;justify-content:flex-end;padding-right:10px}
.big-btn{font-size:1.35rem;padding:6px 12px;border-radius:10px;background:rgba(0,0,0,0.35);}

/* Sidebar */
.sidebar{background:linear-gradient(180deg,#071226,#061220);padding:12px;border-radius:10px;min-height:420px}
.stats{display:flex;flex-direction:column;gap:8px}
.stat{display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02)}
.list{margin-top:12px;max-height:220px;overflow:auto}
.list .item{display:flex;gap:8px;align-items:center;padding:6px;border-radius:6px}
.list img{width:46px;height:46px;object-fit:cover;border-radius:6px}

/* Results modal (simple) */
.results{position:fixed;inset:0;background:rgba(2,6,23,0.7);display:none;align-items:center;justify-content:center;padding:20px}
.results .panel{background:#071627;padding:18px;border-radius:10px;max-width:700px;width:100%}
.results h2{margin-top:0}
footer{margin-top:12px;text-align:center;color:var(--muted);font-size:0.9rem}

@media (max-width:880px){.game-area{grid-template-columns:1fr}.sidebar{order:2}}

  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Party Guessing Game</h1>
      <div class="controls">
        <div class="flex-row">
          <label for="deck">Deck</label>
          <select id="deck">
            <option value="animals">Animals</option>
            <option value="movies">Bollywood Movies</option>
          </select>
        </div>
        <div class="flex-row">
          <label for="timeSec">Time (sec)</label>
          <input id="timeSec" type="number" min="10" value="60" />
        </div>
        <button id="startBtn">Start Game</button>
      </div>
    </header><main class="game-area">
  <section class="card-stage">
    <div class="timer">Time left: <span id="timeLeft">0</span>s</div>
    <div class="card" id="card">
      <img id="cardImg" src="" alt="card image" />
      <div class="caption" id="caption">Press Start</div>
      <div class="overlay" id="overlay">
        <div class="left"><div class="big-btn">❌</div></div>
        <div class="right"><div class="big-btn">✅</div></div>
      </div>
    </div>
    <div style="margin-top:10px;display:flex;gap:8px;align-items:center;justify-content:center">
      <button id="wrongBtn">Mark Wrong (Left)</button>
      <button id="rightBtn">Mark Correct (Right)</button>
    </div>
  </section>

  <aside class="sidebar">
    <div class="stats">
      <div class="stat"><span>Correct</span><strong id="correctCount">0</strong></div>
      <div class="stat"><span>Wrong</span><strong id="wrongCount">0</strong></div>
      <div class="stat"><span>Score</span><strong id="score">0</strong></div>
    </div>

    <div class="list" id="correctList">
      <!-- correct guesses thumbnails -->
    </div>
    <div class="list" id="wrongList">
      <!-- wrong guesses thumbnails -->
    </div>
  </aside>
</main>

<footer>
  Tip: Tap the right half to mark correct, left half for wrong. You can also use keyboard → (correct) and ← (wrong).
</footer>

  </div>  <!-- results modal -->  <div class="results" id="results">
    <div class="panel">
      <h2>Time's up!</h2>
      <p id="resultSummary"></p>
      <div style="display:flex;gap:12px;margin-top:10px;flex-wrap:wrap">
        <button id="playAgain">Play Again</button>
        <button id="downloadReport">Download Report (JSON)</button>
        <button id="closeResults">Close</button>
      </div>
      <div style="margin-top:12px;max-height:300px;overflow:auto" id="resultsDetails"></div>
    </div>
  </div>  <script>
    // --- CONFIG ---
    const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary') || '#c8102e';

    // Animals (names) — we'll use the Unsplash Source endpoint for images (no API key required)
    const ANIMALS = [
      'Lion','Tiger','Elephant','Monkey','Giraffe','Zebra','Dog','Cat','Horse','Rabbit','Panda','Koala','Kangaroo'
    ];

    // Bollywood movie titles (popular ones) — we'll attempt to fetch posters from Wikipedia using the pageimages API
    const MOVIES = [
      '3 Idiots','Dangal','Lagaan','Sholay','Kabhi Khushi Kabhie Gham','Dilwale Dulhania Le Jayenge','Kuch Kuch Hota Hai','PK','Bajrangi Bhaijaan','Andhadhun'
    ];

    // Helper: shuffle in-place
    function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

    // --- State ---
    let deck = [] // array of {title, img}
    let index = 0
    let rightGuesses = []
    let wrongGuesses = []
    let timer = null
    let timeLeft = 0

    // DOM
    const deckSelect = document.getElementById('deck')
    const timeSec = document.getElementById('timeSec')
    const startBtn = document.getElementById('startBtn')
    const cardImg = document.getElementById('cardImg')
    const caption = document.getElementById('caption')
    const overlay = document.getElementById('overlay')
    const timeLeftEl = document.getElementById('timeLeft')
    const correctCount = document.getElementById('correctCount')
    const wrongCount = document.getElementById('wrongCount')
    const scoreEl = document.getElementById('score')
    const correctList = document.getElementById('correctList')
    const wrongList = document.getElementById('wrongList')

    const resultsModal = document.getElementById('results')
    const resultSummary = document.getElementById('resultSummary')
    const resultsDetails = document.getElementById('resultsDetails')
    const playAgainBtn = document.getElementById('playAgain')
    const downloadReportBtn = document.getElementById('downloadReport')
    const closeResultsBtn = document.getElementById('closeResults')
    const wrongBtn = document.getElementById('wrongBtn')
    const rightBtn = document.getElementById('rightBtn')

    // --- Image fetchers ---
    // Unsplash Source: quick anonymous images without API key. Example: https://source.unsplash.com/800x600/?lion
    // We'll append a signature to reduce caching.
    function unsplashFor(query){
      const sig = Date.now().toString(36) + Math.floor(Math.random()*1000)
      return `https://source.unsplash.com/800x600/?${encodeURIComponent(query)}&sig=${sig}`
    }

    // Wikipedia pageimages API: returns thumbnails for many movie pages (no API key). We'll use origin=* for CORS.
    async function wikiPosterFor(title){
      const api = 'https://en.wikipedia.org/w/api.php?action=query&format=json&origin=*&prop=pageimages&piprop=thumbnail&pithumbsize=600&titles=' + encodeURIComponent(title)
      try{
        const res = await fetch(api)
        const data = await res.json()
        if(data && data.query && data.query.pages){
          const pages = data.query.pages
          const page = pages[Object.keys(pages)[0]]
          if(page && page.thumbnail && page.thumbnail.source){
            return page.thumbnail.source
          }
        }
      }catch(e){
        console.warn('wiki poster failed',e)
      }
      // fallback to unsplash search for 'bollywood poster title'
      return unsplashFor('bollywood poster ' + title)
    }

    // Build deck for selected type, prefetch images
    async function buildDeck(type){
      if(type === 'animals'){
        // simple: map animals to unsplash images
        const arr = ANIMALS.map(a=>({title:a, img:unsplashFor(a)}))
        return shuffle(arr)
      }else{
        // movies: try to fetch posters from wikipedia for each movie (fetch in parallel)
        const promises = MOVIES.map(async (m)=>{
          const img = await wikiPosterFor(m)
          return {title:m, img}
        })
        const results = await Promise.all(promises)
        return shuffle(results)
      }
    }

    // UI updates
    function renderCard(){
      if(!deck.length){
        cardImg.src = ''
        caption.textContent = 'No cards'
        return
      }
      const item = deck[index % deck.length]
      cardImg.src = item.img
      cardImg.alt = item.title
      caption.textContent = item.title
    }

    function updateStats(){
      correctCount.textContent = rightGuesses.length
      wrongCount.textContent = wrongGuesses.length
      scoreEl.textContent = rightGuesses.length - wrongGuesses.length

      // lists
      correctList.innerHTML = ''
      rightGuesses.slice().reverse().forEach(g=>{
        const el = document.createElement('div');el.className='item';
        el.innerHTML = `<img src="${g.img}" alt="" /><div style="flex:1"><strong>${g.title}</strong></div>`
        correctList.appendChild(el)
      })

      wrongList.innerHTML = ''
      wrongGuesses.slice().reverse().forEach(g=>{
        const el = document.createElement('div');el.className='item';
        el.innerHTML = `<img src="${g.img}" alt="" /><div style="flex:1"><strong>${g.title}</strong></div>`
        wrongList.appendChild(el)
      })
    }

    // Start / stop
    async function startGame(){
      startBtn.disabled = true
      startBtn.textContent = 'Preparing...'
      rightGuesses = []
      wrongGuesses = []
      updateStats()
      deck = await buildDeck(deckSelect.value)
      index = 0
      renderCard()

      timeLeft = Math.max(10, parseInt(timeSec.value,10)||60)
      timeLeftEl.textContent = timeLeft

      timer = setInterval(()=>{
        timeLeft -= 1
        timeLeftEl.textContent = timeLeft
        if(timeLeft <= 0){
          endGame()
        }
      },1000)

      startBtn.textContent = 'Running...'
      startBtn.disabled = true
    }

    function endGame(){
      if(timer) clearInterval(timer)
      startBtn.disabled = false
      startBtn.textContent = 'Start Game'
      // show modal results
      resultSummary.innerHTML = `You guessed <strong>${rightGuesses.length}</strong> correct and <strong>${wrongGuesses.length}</strong> wrong.`
      resultsDetails.innerHTML = `<h3>Correct</h3>` + rightGuesses.map(g=>`<div style="display:flex;gap:8px;align-items:center;margin:6px 0"><img src='${g.img}' style='width:60px;height:40px;object-fit:cover;border-radius:6px'/> <div><strong>${g.title}</strong></div></div>`).join('')
      resultsDetails.innerHTML += `<h3 style='margin-top:10px'>Wrong</h3>` + wrongGuesses.map(g=>`<div style="display:flex;gap:8px;align-items:center;margin:6px 0"><img src='${g.img}' style='width:60px;height:40px;object-fit:cover;border-radius:6px'/> <div><strong>${g.title}</strong></div></div>`).join('')
      resultsModal.style.display = 'flex'
    }

    function recordGuess(isCorrect){
      if(!deck.length) return
      const item = deck[index % deck.length]
      if(isCorrect) rightGuesses.push(item)
      else wrongGuesses.push(item)
      index++
      renderCard()
      updateStats()
    }

    // click handler on overlay
    overlay.addEventListener('click', (e)=>{
      const rect = overlay.getBoundingClientRect()
      const x = e.clientX - rect.left
      const half = rect.width/2
      recordGuess(x>half)
    })

    // also support the separate buttons
    wrongBtn.addEventListener('click',()=>recordGuess(false))
    rightBtn.addEventListener('click',()=>recordGuess(true))

    // keyboard support
    window.addEventListener('keydown',(e)=>{
      if(e.key === 'ArrowRight') recordGuess(true)
      if(e.key === 'ArrowLeft') recordGuess(false)
    })

    startBtn.addEventListener('click',startGame)

    playAgainBtn.addEventListener('click',()=>{resultsModal.style.display='none';startGame()})
    closeResultsBtn.addEventListener('click',()=>{resultsModal.style.display='none'})

    downloadReportBtn.addEventListener('click',()=>{
      const report = {deckType:deckSelect.value,timePlayed:parseInt(timeSec.value||0,10),correct:rightGuesses,wrong:wrongGuesses}
      const blob = new Blob([JSON.stringify(report,null,2)],{type:'application/json'})
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url; a.download = 'party_guessing_report.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url)
    })

    // initial render
    timeLeftEl.textContent = 0

    // Note to developer / user: If you'd rather use professional movie APIs (TMDb or OMDb) to get posters & metadata,
    // you can swap the wikiPosterFor() implementation for TMDb/OMDb fetches (those need API keys). See instructions in chat.
  </script></body>
</html>
